# Application Settings

アプリケーションの動作に関する設定を行うための画面。

下記のいずれかの操作を行うと、アプリケーション設定を表示することができる。

- 入力画面で`setting`コマンドを実行する
- タスクトレイのアイコンを右クリックし、`アプリケーションの設定`を選択する

## App

ランチャーの基本動作にかかわる設定をする画面  
主に入力画面を表示する際の動作の設定を行う。

![](../image/setting.png)

- `ランチャー呼び出しキー`
  - 入力画面を表示するためのホットキーを設定することができる
- `入力画面を非表示にして起動する`
  - チェックすると、起動直後に入力画面を表示しない
- `入力画面を最前面に表示`
  - 入力画面を表示するとき、入力画面を他のウインドウより前面に表示するようにする
- `入力画面の表示位置`  
入力画面を表示するときの位置を以下の3つから選択できる
  - `前回の表示位置`  
前回と同じ位置に入力画面を表示する
  - `マウスカーソル位置`  
入力画面を表示するタイミングでのマウスカーソル位置に入力画面を表示する
  - `アクティブウインドウの中央`  
アクティブなウインドウの中央に表示する  
ただし、アクティブなウインドウがない場合は前回と同じ位置に表示する
- `すでにアクティブなときに呼び出しキーを押したら隠れる`
  - チェックすると、ランチャー呼び出しキーを押すたびに入力画面の表示/非表示が切り替わる
- `フォーカスを失ったらウインドウを隠す`
  - チェックすると、入力画面がフォーカスを失ったときに、入力画面を非表示にする
- `隠れるときに入力文字列を消去しない`
  - チェックすると、コマンドを実行せずに入力画面を非表示にする際に入力文字列を消去しない
    - 入力画面を次回再表示した際に、前回入力していた内容が維持される

### App HotKey

ランチャーアプリの入力ウインドウを呼び出すためのキー設定画面

![](../image/hotkeyForApp.png)

- `ホットキーを設定する`  
修飾キー(`Alt` `Ctrl` `Shift` `Win`) + 任意のキーを同時押しすることによりアプリを表示する
  - `修飾キー`  
修飾キーを選択するためのもの。
  - 例: `Ctrl`のみチェックし、キーとして`A`を選択した場合  
Ctrl+A
  - `キー`  
文字を選択する
- `修飾キーの組み合わせ入力`  
修飾キー(`Alt` `Ctrl` `Shift` `Win`)を二つ組み合わせ入力することによりアプリを表示する方式  
同じキーを2回押す、あるいは、異なるキーを同時押しすることでアプリを起動することができる  
例: `Ctrl`キーの2回押し、あるいは、`Ctrl`+`Alt`キーの同時押し
  - `一つ目の入力`  
一つ目に入力する修飾キーを選択する
  - `二つ目の入力`  
二つ目に入力する修飾キーを選択する


----

## App > Shortcut

各種ショートカット登録をするための画面  
いずれもチェックすると登録され、チェックを外すと登録が解除される

![](../image/setting2.png)

- `「送る」から登録できるようにする`
  - チェックすると、本アプリにコマンドを登録するためのメニューが、エクスプローラのコンテキストメニューの「送る」に追加される
![](../image/sendto.png)

- `スタートメニューに登録する`
  - チェックすると、本アプリを起動するためのメニューがスタートメニューに登録される

- `デスクトップに登録する`
  - チェックすると、本アプリを起動するためのショートカットがデスクトップに配置される

- `スタートアップに登録する`
  - チェックすると、Windowsにログオン(サインイン)した後に自動で本アプリを起動する

- `作成したショートカットをすべて削除する`
  - 上記で作成したショートカットをすべて削除する

----

## App > Sound Effects

画面操作時に効果音を鳴らす設定をするための画面  
もし、音を鳴らせる環境で作業しているのであれば、気分が上がる効果音を設定すると、作業効率がアップするかもしれない。

mp3ファイルのみ指定可能(他の音声ファイルには非対応)

![](../image/setting7.png)

- `入力欄への文字入力`
  - 入力欄に文字を入力したときに再生するmp3ファイルを指定する。空欄の場合は何も再生しない。
- `候補欄の選択項目変更`
  - 候補欄の選択項目を変更したときに再生するmp3ファイルを指定する。空欄の場合は何も再生しない。
- `コマンド実行`
  - コマンドを実行するときに再生するmp3ファイルを指定する。空欄の場合は何も再生しない。

## Keyword Input

入力画面のキーワード入力回りの動作に影響する設定を行うための画面

![](../image/setting3.png)

- `入力画面を表示するときにIMEをオフにする`
  - チェックすると、入力画面を表示したタイミングでIMEをオフにする

- `ネットワークパスを無視する`
  - チェックすると、`\\(コンピュータ名)`で始まるパスを本アプリでは開かないようにする
    - 環境によっては、ネットワークパスの情報を参照したときに数十秒ほど固まることがあるため

- `C/Migemoによるローマ字検索を有効にする`
  - [C/Migemo](https://www.kaoriya.net/software/cmigemo/) という外部ライブラリを用いて、ローマ字でのキーワード絞り込みをできるようにする
    - たとえば、`jikoku`というキーワードで`時刻`や`自国`という文言にマッチするようになる
    - 配布元(上記リンク先)からライブラリを入手し、配置する必要がある
  - 下記のような構成になるように配置する。
```
アプリ配置フォルダ/
    (アプリ名).exe
    dict/
      utf-8/    ※ dictフォルダ内にあるutf-8の方の辞書を参照する
    migemo.dll
```

なお、バージョン{{version}}現在、migemo.dllと辞書データは本アプリに同梱しているため、上記の配置作業は不要。

## Keyword Input > Key Config

入力画面の操作に関するキーを設定する画面  
独自のキーバインドで上下左右の移動や決定操作を行うアプリケーションがある。(例: Emacsの`Ctrl-N` `Ctr-P` `Ctrl-M`など）。  
それらのアプリの使用感に寄せるための設定

![](../image/appsetting-key.png)

- `入力キーの画面割り当て`
  - `上へ`
    - 候補欄の選択項目を一つ上へ移動するキーを割り当てる
  - `下へ`
    - 候補欄の選択項目を一つ下へ移動するキーを割り当てる
  - `決定`
    - 入力画面での入力内容を確定させるキーを割り当てる
  - `補完`
    - 入力画面での入力内容を補完するキーを割り当てる
  - `メニュー表示`
    - 選択している候補のコンテキストメニューを表示するキーを割り当てる
  - `テキストをコピー`
    - 入力欄に入力された文字列をクリップボードにコピーする  
コピーした後、入力欄は非表示になる
- `入力画面のウインドウ移動`  
入力画面を一時的に上下左右に移動するキーの割り当てを行う(次回表示時は元の位置に戻る)。  
入力画面の後ろにあるテキストをランチャーに手入力するにあたり、入力画面を一時的に移動したい、というケースで使う
  - `上へ移動`
    - 入力画面を上方向に移動する
  - `下へ移動`
    - 入力画面を下方向に移動する
  - `左へ移動`
    - 入力画面を左方向に移動する
  - `右へ移動`
    - 入力画面を右方向に移動する
  

- `初期設定に戻す`
  - 上記のキー割り当てをすべて解除する

## Keyword Input > History

![](../image/appsetting-inputhistory.png)

- `履歴機能を使う`
  - [履歴](/adhoc-command/history)機能の有無を設定できる
- `履歴件数`
  - 履歴として登録する件数の上限を設定する
- `履歴の削除`
  - ボタンをクリックすると全ての履歴をクリアする

## Comand Execute

![](../image/setting4.png)

- `フォルダを開くファイラーを指定`
  - チェックすると、エクスプローラ以外のファイラーを使うことができる
- `ファイラーのパス`
  - 起動する外部ファイラーの実行ファイルのパスを指定する
- `パラメータ`
  - `ファイラーのパス`で指定したファイラーを起動するときのパラメータを指定する
  - `$target`が実際に開かれる対象(ファイルやフォルダ)のパスに置き換えられる

- `「ファイル名を指定して実行」機能を使用する`
  - チェックすると、 [`ファイル名を指定して実行`](#ファイル名を指定して実行) コマンドを有効にする。

- `未登録キーワード入力時の動作`  
コマンドとして登録されていない（かつ、[コマンドとして登録していなくても実行できる機能](/adhoc-commands) として作用しない） キーワードを入力したときの動作を指定する  
以下の3つから選択できる。
  - 何もしない
  - クリップボードにコピー
  - キーワードをコマンド登録

- `管理者特権で起動する`
  - ランチャーアプリを起動するときに管理者権限で起動する  
管理者権限で実行することにより、他の管理者権限プロセスがアクティブな状況でもランチャーのホットキーが効くようになる。  
 (ランチャーを通常ユーザー権限で実行している場合、管理者権限で動作するプロセス(のウインドウ)がアクティブになっている状況においてホットキーが効かない)
- `【管理者特権で実行時】コマンドを通常ユーザ権限で起動する`
  - 管理者特権でアプリケーションを実行している状況において、ランチャーから起動するコマンドを一般ユーザー権限で実行する
    - ランチャー自体は管理者権限で実行したいけれど、一方で、(セキュリティ上の理由により)コマンド実行により起動するアプリケーションを管理者権限で動かしたくない場合に使う

## Comand Execute > Path

[`ファイル名を指定して実行`](/adhoc-command/pathfind) コマンドにおける、実行ファイルを検索するフォルダを追加で指定することができる。  
検索の優先順位としては環境変数PATHで設定されたフォルダ、次に追加のディレクトリ、の順で検索を行う。  
リストの上にある項目が優先される。

![](../image/appsetting-path.png)

- `環境変数PATHで設定されたディレクトリ`
  - システムの環境設定で指定されたディレクトリが表示される
    - このリストは参照専用

- `追加のディレクトリ`
  - システム設定で指定されたもの以外に検索したいディレクトリを登録する

- `追加`
  - クリックすると、ディレクトリ選択ダイアログが表示される。選択したディレクトリが`追加のディレクトリ`に追加される
- `編集`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目のパスを変更することができる
- `削除`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目を削除することができる
- `上へ`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目を一つ上に移動する
- `下へ`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目を一つ下に移動する

## Command Execute > Exclude Files

[`ファイル名を指定して実行`](/adhoc-command/pathfind) コマンドにおいて、対象外とするファイルを指定することができる。  


![](../image/appsetting-excludefile.png)

- `除外するファイル`
  - ここで登録したファイルが候補としてマッチした場合でも、候補に表示しないようにする。

- `追加`
  - クリックすると、ファイル選択ダイアログが表示される。選択したファイルが`除外するファイル`に追加される
- `編集`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目のパスを変更することができる
- `削除`
  - クリックすると、`追加のディレクトリ`リスト上の選択項目を削除することができる

## Command Execute > Priority

コマンドの優先度を設定することにより、候補欄に表示されるコマンドの順序を制御するための画面。

![](../image/appsetting-commandpriority.png)

- `コマンドの優先度`
  - コマンドごとの優先度が表示されたリスト
  - 優先度の数値が高いものほど先に表示される。
- `フィルター`
  - リスト上に表示するコマンドの絞り込みを行うことができる
- `優先度変更`
  - `コマンドの優先度`リストで選択した項目の優先度を変更する
- `すべてリセット`
  - `コマンドの優先度`リスト上に表示されたすべての項目の優先度を0にする

### Example

たとえば、下記の設定がされていた場合、
入力欄に「b」と打った場合に、`bookmark` `blog-hatena` `board` の順に表示される。  

|コマンド|優先度|
|--|--|
|blog-hatena|5|
|board|0|
|bookmark|10|


### Restrictions

- 利用者が[登録したコマンド](/usage/how_to_use.md#register-command)に対してのみ、コマンドの優先度を設定することができる
  - [コマンドとして登録していなくても実行できる機能](/adhoc-commands) に由来するコマンドに対して優先度を設定することはできない

## Appearance

入力画面の外観にかかわる設定を行う。

![](../image/setting5.png)

- `入力画面のフォント`
  - 入力画面のフォントを指定する
  - 初期値は`Noto Sans JP`フォント(利用できない場合は`Tahoma`)
- `サイズ`
  - 入力画面のフォントサイズをポイント単位で指定する
  - 初期値は9
  - 設定できる範囲は6～128
- `既定値を使用`
  - 入力画面のフォント/フォントサイズを初期値に戻す

- `コメント表示欄の初期表示テキスト`
  - 入力画面を表示した直後のコメント欄のテキストを設定する
  - テキストに[マクロ](/macros)を使うことができる  
![](../image/defaultcomment.png)
- `入力画面のアイコンを表示する`
  - 入力画面上のアイコン表示欄を表示する
- アイコン欄
  - アイコン欄をダブルクリック、または、右クリックからコンテキストメニュー`アイコンを変更する`を選択すると、ファイル選択ダイアログを表示する。ファイルを選択すると、初期表示アイコンを変更することかできる
    - 使用可能なファイル形式は`.ico`のみ
- `デフォルトのアイコンに戻す`
  - 変更した初期表示アイコンをアプリ本来のアイコンに戻す
- `入力画面のプレースホルダーを表示する`
  - 入力欄に何も文字を入力していない状態のときにテキストを表示する  
![](../image/placeholder.png)
- `操作ガイド欄を表示する`
  - チェックすると、コメント表示欄の下に操作ガイド欄を表示する  
![](../image/guidelabel.png)
- `候補欄にコマンド種別を表示する`
  - チェックすると、コマンドの種別を候補リストに表示する  
![](../image/showcmdtype.png)
- `候補欄の背景色を交互に変える`
  - チェックすると、候補欄の奇数行と偶数行の背景色を変えて表示を行う  
![](../image/alternatecolor.png)
- `候補欄の各項目のアイコンを表示する`
  - チェックすると、候補欄の項目ごとにアイコンを表示する
  - 左: アイコンを表示する場合  右:表示しない場合  
![](../image/showicon.png)
- `入力欄の透過表示`
  - `半透明`  
入力画面を半透明にするタイミングの設定。以下の3つから選択する。
    - `非アクティブなときに半透明`  
入力画面がフォーカスを失ったときに半透明表示にする
    - `いつでも半透明`  
フォーカスの有無にかかわらず常に入力画面を半透明表示にする
    - `半透明にしない`  
フォーカスの有無にかかわらず常に入力画面を半透明表示にしない
  - `透明度`
    - 入力画面を透過表示するときの透明度を0～255の範囲で指定する
    - 0は完全に透明
      - 255は完全に不透明

## Appearance > Colors

![](../image/appsetting-color.png)

- `システムの色設定を使用する`
  - チェックすると、Windowsのシステム設定の配色でウインドウを描画する
  - チェックしない場合は、アプリで独自設定した色を使用する

- `システムの色設定に戻す`
  - 色設定を初期値に戻す


- `ウインドウ`
  - `テキスト`  
ウインドウのコメント欄、ガイド欄の文字色を設定する
  - `背景`  
ウインドウの背景色を設定する
- `入力欄`
  - `テキスト`  
入力欄の文字色を設定する
  - `背景`  
入力欄の背景色を設定する
- `候補欄`
  - `テキスト`  
候補欄の文字色を設定する
  - `背景`  
候補欄の背景色を設定する
  - `背景(交互)`  
`候補欄の背景色を交互に変える`をチェックしたときの候補欄の偶数行目の背景色を設定する
  - `選択テキスト`  
候補欄の選択行の文字色を設定する
  - `選択背景`  
候補欄の選択行の背景色を設定する

## Extensions

![](../image/setting6.png)

- `簡易電卓機能`>`有効にする`
  - チェックすると、入力画面に入力したテキストを数式として評価して、その計算結果を表示する  
![](../image/calculator.png)
  - `Enter`キーを押すと、計算結果をクリップボードにコピーする
  - [Python3](https://www.python.org/)が必要
- `簡易電卓機能`>`Python DLLのパス`
  - PCにインストールした`Python3`の本体DLLへのパスを指定する

- `システム関連の機能`
  - `コントロールパネル項目を候補として表示する`
    - チェックすると、コントロールパネル項目を候補として表示し、それを実行したら、該当するコントロールパネル項目を開く  
![](../image/controlpanel-command.png)
  - `スタートメニュー／最近使ったファイルを候補として表示する`
    - チェックすると、ファイルを候補として表示・実行する
      - スタートメニューに登録されたプログラム
      - Windowsの`最近使ったファイル`に登録されたファイル
  - `アプリケーション(UWPアプリなど)を候補として表示する`
    - チェックすると、実行環境にインストールされているアプリケーション(UWPアプリを含む)を候補として表示・実行する
  - `MMCスナップインを候補として表示する`
    - チェックすると、実行環境にインストールされている[MMCスナップイン](/adhoc-command/mmcsnapin)を候補として表示する
  - `Windowsの設定を候補として表示する`
    - チェックすると、[Windows設定](/adhoc-command/windowssettings)の各ページ項目を候補として表示する
  - `環境変数を候補として表示する`
    - チェックすると、[環境変数](/adhoc-command/env)の一覧を候補として表示する

## Extensions > Switch Window

ウインドウ切替関連機能に関する設定を行う画面

![](../image/appsetting-switchwindow.png)

- `ウインドウタイトルによる選択を有効にする`  
画面に表示されているウインドウのタイトルを候補として表示し、それを実行したら該当するウインドウをアクティブにする  
![](../image/activate_window.png)
- `プレフィックス`  
`ウインドウタイトルによる選択を有効にする`の候補を表示するためキーワードを指定する  
キーワードを入力した時点で、ウインドウの一覧が表示される(上図参照)  
初期値は`wl` (`w`indow`l`ist の略)

- `ExcelやLibreOffice Calcのシート名による選択を有効にする`  
入力画面を表示した時点で開いているExcel / LibreOffice Calcのシート名の一覧を候補として検索し、それを実行したら該当するシートをアクティブにする
  - 機能を利用するためにはExcel(デスクトップ版) または LibreOfficeがインストールされている必要がある
- `プレフィックス`  
`ExcelやLibreOffice Calcのシート名による選択を有効にする`の候補を表示するためキーワードを指定する  
キーワードを入力した時点で、シートの一覧が表示される
初期値は`xj` (e`x`cel `j`ump の略)
- `PowerPointのスライドタイトルによる選択を有効にする`  
入力画面を表示した時点でアクティブなPowerPointプレゼンテーションのスライドタイトルを候補として検索し、それを実行したら該当するシートをアクティブにする
  - 機能を利用するためにはPowerPoint(デスクトップ版)がインストールされている必要がある
- `プレフィックス`  
`PowerPointのスライドタイトルによる選択を有効にする`の候補を表示するためキーワードを指定する  
キーワードを入力した時点で、スライドの一覧が表示される
初期値は`pj` (`p`owerpoint `j`ump の略)


## Extensions > Clipboard History

[クリップボード履歴](/adhoc-command/clipboard-history)機能に関する設定を行う画面

![](../image/appsetting-clipboardhistory.png)

- `有効にする`
  - チェックすると、[クリップボード履歴](/adhoc-command/clipboard-history)機能を有効にする
- `プレフィックス`
  - クリップボード履歴を候補として表示するためのキーワードを指定する  
![](../image/clipboardhistory-prefix.png)
- `検索結果表示件数`
  - 候補に表示する件数の上限を指定する
- `登録時の1件あたり上限サイズ`
  - クリップボードが更新されたとき、テキストのサイズが指定サイズを超過する場合は履歴に追加しない
- `履歴件数の上限`
  - 履歴の件数が上限を超過したら、古いものから履歴を削除する
- `次の記録を有効にするまでの間隔`
  - 前回のクリップボード更新から、指定した時間が経過しないうちに更新が再度行われた場合は履歴に追加しない
- `無視するパターン`
  - 指定した正規表現パターンに合致するテキストを履歴に追加しない
- `クリップボード履歴ではC/Migemoを使用しない`
  - チェックすると、クリップボード履歴の候補の絞り込みにおいて、C/Migemoによる正規表現マッチングを使用しない
    - 現状のアプリの実装だと、クリップボード履歴の絞り込みにおいてC/Migemoが生成した正規表現を使ってマッチングをすると、すこし遅い感じがあるため無効化できるようにする
    - チェックを外した場合は[入力](/window/app-settings.md#keyword-input)設定に従う
- `プレビューウインドウを表示する`
  - チェックすると、候補欄で選択したクリップボード履歴のテキスト内容を確認するためのプレビューウインドウを表示する。

## Extension > Path Conversion

![](../image/appsetting-pathconvert.png)

- `git-bashパスをローカルパス表記に変換する`
  - チェックすると、[git-bashパス変換](/adhoc-command/git-bash-pashconvert)を有効にする
- `file://...をローカルパス表記に変換する`
  - チェックすると、[fileプロトコルをローカルパスに変換](/adhoc-command/file-pathconvert)を有効にする

## Extension > Everything

![](../image/adhoc-command/everything-appsetting.png)

- `機能を有効にする`  
チェックすると、[Everything検索](/adhoc-command/everything)機能が有効になる。
- `プレフィックス`  
検索を開始するためのキーワードを指定する。  
空欄にすると、Everything検索が常に有効になる。
- `Everythingが起動していなかった場合に起動する`  
チェックした場合、Everythingのアプリが起動していなかった場合に起動を試みる。  
(Everything検索を行うためにはEverythingのアプリが起動している必要がある)
- `Everything.exe`のパス  
アプリを起動する際の実行ファイルのパスを指定する。

## Extension > WinSCP

![](../image/adhoc-command/winscp-appsetting.png)

- `機能を有効にする`  
チェックすると、[WinSCPのセッション一覧を表示する](/adhoc-command/winscp)機能が有効になる。
- `ポータブル版のWinSCPを利用する`  
インストール版のWinSCPではなく、ポータブル版のWinSCPを使用している場合に使用する設定。  
チェックすると、`WinSCP.exeのパス`欄が有効になる。  
- `WinSCP.exeのパス`  
ポータブル版のWinSCPを使用している場合の`WinSCP.exe`のパスを指定する。

## Logging

![](../image/appsetting-other.png)


- `ログ出力レベル`
  - デバッグ用機能。デバッグ用ログファイルへの出力対象とするログ種別を選択することができる
  - 下のものほど情報量が多くなる
  - ログファイルの出力先は`<設定ファイルの保存先>/per_machine/<PC名>/<アプリ名>.log`

|選択肢|説明|
|--|----|
|なし|ログを一切出力しない|
|エラー|エラーログのみ出力する|
|警告|エラーと警告ログを出力する|
|通常|エラーと警告と通常ログを出力する|
|デバッグ|デバッグ用出力も含めたすべてのログを出力する|

- `性能ログを出力する`
  - デバッグ用機能。内部処理の処理時間に関するログを専用のログファイルに出力する。  
出力先は`<設定ファイルの保存先>/per_machine/<PC名>/perf.log`

- `連続で作業していたら警告する`
  - チェックすると、`警告を表示するまでの時間`で設定した時刻を超えて連続稼働(スクリーンロックを挟まずにPCを起動)した場合に警告メッセージを表示する
- `警告を表示するまでの時間`
  - 警告を表示するまでの時間を分数で指定する(デフォルトは90分)

## Others

### Application HotKey

ランチャーアプリの入力ウインドウを呼び出すためのキー設定画面

![](../image/hotkeyForApp.png)

- `ホットキーを設定する`  
修飾キー(`Alt` `Ctrl` `Shift` `Win`) + 任意のキーを同時押しすることによりアプリを表示する
  - `修飾キー`  
修飾キーを選択するためのもの。
  - 例: `Ctrl`のみチェックし、キーとして`A`を選択した場合  
Ctrl+A
  - `キー`  
文字を選択する
- `修飾キーの組み合わせ入力`  
修飾キー(`Alt` `Ctrl` `Shift` `Win`)を二つ組み合わせ入力することによりアプリを表示する方式  
同じキーを2回押す、あるいは、異なるキーを同時押しすることでアプリを起動することができる  
例: `Ctrl`キーの2回押し、あるいは、`Ctrl`+`Alt`キーの同時押し
  - `一つ目の入力`  
一つ目に入力する修飾キーを選択する
  - `二つ目の入力`  
二つ目に入力する修飾キーを選択する

-----------

## Key Assignment

コマンドに対するキー割り当てを行うための画面。  
割り当てたキーを押すとコマンドを実行することができる。

![](../image/hotkeyForCommand.png)

- `ホットキーを設定する`  
コマンドに対してキー割り当てを行う場合はチェックする

- 種別
  - 以下の3つのいずれかを選択する。  
`アクティブ時のみ有効` or `アクティブ時のみ有効(SandS)`  or `常駐時いつでも有効`
  - 種別の説明は[ホットキーの種別について](/others/hotkey)を参照
- `修飾キー`
  - 修飾キーを選択するためのもの。
  - 例: `Ctrl`のみチェックし、キーとして`A`を選択した場合 → Ctrl+A
  - 種別として`アクティブ時のみ有効(SandS)`を選択した場合は以下の5つのいずれかを選択することができる。  
`Space` `CapsLock` `変換` `無変換` `かな`
- `キー`
  - 修飾キーと組み合わせる文字を選択する

##### HotKey Type

- ホットキーの種別として以下の3つを選択できる
  1. `アクティブ時のみ有効`
  1. `アクティブ時のみ有効(SandS)`
  1. `常駐時いつでも有効`

- `アクティブ時のみ有効`と`アクティブ時のみ有効(SandS)`は入力画面が表示されているときだけ機能する。
一方、`常駐時いつでも有効`は入力画面が表示されていないときでも機能する。

- `アクティブ時のみ有効(SandS)`の`SandS`は「Space and Shift」の略で、単体でキーを押したときは文字キー(→Space)として機能し、  
他のキーと同時押ししたときは修飾キー(→Shift)として機能する、という概念のこと
  - ランチャー呼び出しキーの修飾キーと`SandS`の修飾キーを同じキーとして設定することにより、スムーズにコマンドを呼び出すことができる
    - 例:  
ランチャー呼び出しのホットキーを`CapsLock`にして、コマンドのホットキーを`CapsLock`+`J`に設定していたとすると、以下のような動きになる  
![](../image/sands-example.png)
    - つまり、他アプリとのキー割り当ての干渉をあまり気にすることなく、グローバルホットキー的な機能が実現できる

###### HotKey Type Comparison

それぞれ実現している仕組みが異なる。  
`常駐時いつでも有効`はシステムのホットキーに登録するため、登録したキーを使って、いつでも呼び出せる一方で、ほかのアプリ内においてそのキーを使うことができなくなる

|種別|メリット|デメリット|
|--|----|----|
|`アクティブ時のみ有効`|他アプリに干渉しない<br>他アプリへの干渉を気にする必要がないのでキー選択の幅が広い|まずアクティブにする(入力画面を表示する)必要がある|
|`アクティブ時のみ有効(SandS)`|SandSの修飾キーを[ランチャー呼び出しキー](/window/app-settings.md#app)の修飾キーと合わせることにより、スムーズな運指が実現できる|まずアクティブにする(入力画面を表示する)必要がある|
|`常駐時いつでも有効`|いつでも呼び出せる|登録したキーを他アプリで使えなくなってしまう<br>他アプリに干渉することをふまえて割り当てるキーを慎重に選択する必要がある|

##### Constraints Related to SandS

- SandSの修飾キーとして選択したキーを押しっぱなしにした場合、普通の文字入力としてキーリピートする。
  - `Shift` `Ctrl` `Alt` `Win`などのような純粋な修飾キーのような動きにはならない
- SandSを実現するためにキーフックを利用している。キーフックの仕組みを用いた別のソフトが同時に動いている場合、競合してうまく動作しない場合がある


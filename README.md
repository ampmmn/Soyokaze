# Soyokaze

コマンドラインランチャー、キーボードランチャー、キーストロークランチャーと呼ばれる種類のランチャーソフト。  
Windows向け。

bluewindのUIを参考にして作成している。  
bluewindの使用感を維持しつつ、現行のWindows環境でも動作するコマンドラインランチャーを実現することを目的としている。


![画面](image/soyokaze-window.gif)

- ホットキーを押すと、検索ウインドウが表示される。ウインドウ上でキーワードを入力することにより、様々な操作を素早く行うことができる。

## 主な特徴

- ホットキーでウインドウの呼び出しができる。初期値はAlt-Space
  - キー割り当てを変更可能
- 参考にしたbluewindの主要機能についてはだいたいサポートしている
  - 任意のファイルやフォルダを登録してキーワードで呼び出すことができる
  - 登録したキーワード(コマンド)に対してショートカットキーを設定することができる
  - 複数のコマンドをグループでまとめて実行することができる
- Migemo検索に対応している

- 加えて、ここ近年の類似ツールで実装している機能について、本ツールも実装している
  - UWPやスタートメニュー、コントロールパネルなどの項目を表示することができる
  - ブラウザのブックマークや履歴を検索することができる
  - 任意のWebサイトのクエリパラメータを登録することにより、Web検索をコマンドとして実行することができる
  - 複数のウインドウを整列、ウインドウの切り替え
  - 電卓機能
  - ~~Everything連携~~ 現在作り直すために機能を無効化している

- 他ツールであまり見かけないめずらしい機能も実装している
  - 開いているExcelのシート名からのシート切り替え
  - 開いているPowerPointスライドのスライドタイトルからのスライド切り替え
  - Excelの任意の範囲のデータをKey-Value型データベースと見立ててクエリができる
    - 絞り込み結果を使った任意の操作ができる
      - 辞書のようにも使えるし、選択した結果に基づいてURLを開いたりなど、活用方法いろいろ
  - ファジーファインダー風の機能
    - 起動した別プログラムの標準出力から絞り込み/選択を行い、選択結果を使って任意の操作を行う
  - Base64/エスケープシーケンスなどのデコード
  
## 動作環境

下記環境での動作を確認済

- Windows 11(64bit)
- Windows 10(64bit)

## インストール手順

1. zipをファイルを展開して任意のフォルダに展開する
1. 展開先フォルダにある`soyokaze.exe`を実行する
1. 設定情報の以下のいずれかの場所に保存される
  - 実行ファイルと同じディレクトリに`profile`フォルダがある場合は`profile`以下に設定ファイル一式を保存する
  - そうでない場合は、ユーザフォルダ(たいていは C:/Users/(ユーザ名))直下の`.soyokaze`フォルダに保存される  
初回実行時に`.soyokaze`フォルダを作成する
  * レジストリを一切変更しない

## アンインストール手順

アンインストーラはないため、以下すべてを手動で行う。

1. アプリケーションの設定-ショートカット設定を表示し、すべてのショートカットを削除する
1. `soyokaze.exe`を終了する
1. インストール時に`soyokaze.exe`を置いたフォルダごと削除する
1. 設定フォルダ(C:/Users/(ユーザ名)/.soyokaze)を削除する

## ファイル構成

- soyokaze.exe
- help.html
- LICENSE
- files/
- migemo.dll
- sandshook.dll

## マニュアル

[マニュアル](doc/help.md) を参照

- `Pandoc`からHTMLを生成するためのMarkdownファイルのため、そのための記述がファイル冒頭と末尾にある

## 実行時に必要なライブラリ

以下のライブラリがあると、追加の機能を利用することができるが、なくても動作する。

- [Python3](https://www.python.org/) 
  - 電卓機能を利用するために必要

- [C/Migemo](https://www.kaoriya.net/software/cmigemo/) 
  - ローマ字による日本語文字列検索を利用するために必要
    - 例えば、`jikoku`で`時刻`や`自国`にヒットするようになる

## 画面など

画面のつくりはbluewindにある程度似せて作っている

### 入力画面

![](image/soyokaze-window.png)

### キーワードマネージャ

![](image/keywordmanager.png)

### コマンド登録・編集画面

![](image/edit.png)

### 設定画面

![](image/setting.png)

## ビルド方法

[HowToBuild.md](./HowToBuild.md) を参照


### キーワード絞込みの仕様

- 指定したキーワードが候補の名前に部分一致するかどうかで判断を行う
- スペース区切りで複数キーワード指定された場合、個々のキーワードごとに候補の名前と部分一致比較を行い、すべてマッチするものを対象とする

- 一致の度合いに応じて、候補の表示順序を変えている。一致度の区分として以下の4種類がある。  
先に挙げたほうが優先順位が高い(先に表示する)
  - 完全一致
    - キーワードのいずれかが、候補と完全一致する場合、完全一致とみなす
  - 前方一致
    - 先頭のキーワードと候補が前方一致する場合、前方一致とみなす
  - 部分一致
    - 与えられたキーワードが候補に部分的に一致する場合、部分一致とみなす
  - 弱一致
    - 他の区分の候補がない場合に表示対象とする、特殊な区分

- 一致度が同じ場合はコマンドの優先度に従う。優先度はアプリ設定画面から利用者が設定する
- ダブルクォーテーションで囲った場合はキーワードに空白を含めることができる
- 複数のキーワードが与えられた場合に先頭キーワードと候補が完全一致する場合、後続のキーワードをパラメータ指定とみなす

## ToDo

- 設計資料を残す
- ユニットテスト拡充

## ChangeLog

[CHANGELOG.md](./CHANGELOG.md)

## ライセンス

[MIT License](./LICENSE)


## 連絡先

- X(Twitter) : https://x.com/ymgw
- htmnymgw@gmail.com


